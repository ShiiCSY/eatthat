(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();async function g(){return new Promise(e=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(r=>{e({lat:r.coords.latitude,lng:r.coords.longitude})},async()=>{console.warn("Geolocation failed, using IP-based fallback");try{const o=await(await fetch("https://ipwho.is/")).json();o.success?e({lat:o.latitude,lng:o.longitude}):e(null)}catch{e(null)}}):e(null)})}let d=[],i,c=null;async function u(){let e=await g();e||(e={lat:47.6062,lng:-122.3321});const{Map:o}=await google.maps.importLibrary("maps");i=new o(document.getElementById("map"),{center:e,zoom:15,mapId:"5cf4d80f4e5ae41a49c1a06a"}),new google.maps.Marker({position:e,map:i}),m()}async function m(){try{const{Place:e,SearchNearbyRankPreference:r,Money:o}=await google.maps.importLibrary("places"),{AdvancedMarkerElement:l}=await google.maps.importLibrary("marker");let t=i.getCenter();const n={fields:["displayName","formattedAddress","location","priceRange","rating","userRatingCount","priceLevel"],locationRestriction:{center:t,radius:2e3},includedPrimaryTypes:["restaurant"],maxResultCount:20,rankPreference:r.POPULARITY,language:"en-US"},{places:s}=await e.searchNearby(n);if(s&&s.length>0){const p=Math.floor(Math.random()*s.length),a=s[p];i.setCenter(a.location),new l({map:i,position:a.location,title:a.displayName}),document.querySelector(".restaurant-name").textContent=a.displayName,document.querySelector(".restaurant-address").textContent=a.formattedAddress,document.querySelector(".restaurant-rating").textContent=`Rating: ${a.rating} â­ (${a.userRatingCount} reviews)`,document.querySelector(".restaurant-price").textContent=`Price: ${a.priceLevel}`,c=a;const f=document.getElementById("placeProvider");f&&(f.place=a.id)}else console.error("No restaurants found")}catch(e){console.error("Error searching for restaurants:",e)}}u();document.querySelector(".button-30").addEventListener("click",()=>{const e=document.querySelector(".button-30"),r=document.querySelector(".container");e.classList.add("slide-up"),i||u(),m(),setTimeout(()=>{r.classList.remove("hidden"),setTimeout(()=>{r.classList.add("visible")},50)},500)});document.querySelector(".try-again").addEventListener("click",()=>{document.querySelector(".button-30");const e=document.querySelector(".container");document.querySelector(".title"),i||u(),m(),setTimeout(()=>{e.classList.remove("hidden"),setTimeout(()=>{e.classList.add("visible")},50)},500)});document.querySelector(".thats-it").addEventListener("click",()=>{c&&(d.push({name:c.displayName,address:c.formattedAddress,rating:c.rating,timestamp:new Date().toISOString()}),localStorage.setItem("restaurantHistory",JSON.stringify(d)));const e=document.querySelector(".button-30"),r=document.querySelector(".container"),o=document.querySelector(".title");r.classList.remove("visible"),setTimeout(()=>{r.classList.add("hidden")},500),e.classList.remove("slide-up"),o.classList.remove("hidden")});window.addEventListener("load",()=>{const e=localStorage.getItem("restaurantHistory");e&&(d=JSON.parse(e))});
