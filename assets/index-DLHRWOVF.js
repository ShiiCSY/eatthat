(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function a(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(t){if(t.ep)return;t.ep=!0;const r=a(t);fetch(t.href,r)}})();window.initMap=u;async function g(){return new Promise(e=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(n=>{e({lat:n.coords.latitude,lng:n.coords.longitude})},async()=>{console.warn("Geolocation failed, using IP-based fallback");try{const a=await(await fetch("https://ipwho.is/")).json();a.success?e({lat:a.latitude,lng:a.longitude}):e(null)}catch{e(null)}}):e(null)})}let d=[],c,l=null;async function u(){let e=await g();e||(e={lat:47.6062,lng:-122.3321});const{Map:a}=await google.maps.importLibrary("maps");c=new a(document.getElementById("map"),{center:e,zoom:15,mapId:"5cf4d80f4e5ae41a49c1a06a"}),new google.maps.Marker({position:e,map:c}),m()}async function m(){try{const{Place:e,SearchNearbyRankPreference:n,Money:a}=await google.maps.importLibrary("places"),{AdvancedMarkerElement:o}=await google.maps.importLibrary("marker");let t=c.getCenter();const r={fields:["displayName","formattedAddress","location","priceRange","rating","userRatingCount","priceLevel"],locationRestriction:{center:t,radius:2e3},includedPrimaryTypes:["restaurant"],maxResultCount:20,rankPreference:n.POPULARITY,language:"en-US"},{places:i}=await e.searchNearby(r);if(i&&i.length>0){const p=Math.floor(Math.random()*i.length),s=i[p];c.setCenter(s.location),new o({map:c,position:s.location,title:s.displayName}),document.querySelector(".restaurant-name").textContent=s.displayName,document.querySelector(".restaurant-address").textContent=s.formattedAddress,document.querySelector(".restaurant-rating").textContent=`Rating: ${s.rating} â­ (${s.userRatingCount} reviews)`,document.querySelector(".restaurant-price").textContent=`Price: ${s.priceLevel}`,l=s;const f=document.getElementById("placeProvider");f&&(f.place=s.id)}else console.error("No restaurants found")}catch(e){console.error("Error searching for restaurants:",e)}}document.addEventListener("DOMContentLoaded",()=>{u();const e=document.querySelector(".button-30");e&&e.addEventListener("click",()=>{const o=document.querySelector(".container");e.classList.add("slide-up"),m(),setTimeout(()=>{o.classList.remove("hidden"),setTimeout(()=>{o.classList.add("visible")},50)},500)});const n=document.querySelector(".try-again");n&&n.addEventListener("click",()=>{const o=document.querySelector(".container");c||u(),m(),setTimeout(()=>{o.classList.remove("hidden"),setTimeout(()=>{o.classList.add("visible")},50)},500)});const a=document.querySelector(".thats-it");a&&a.addEventListener("click",()=>{l&&(d.push({name:l.displayName,address:l.formattedAddress,rating:l.rating,timestamp:new Date().toISOString()}),localStorage.setItem("restaurantHistory",JSON.stringify(d)));const o=document.querySelector(".button-30"),t=document.querySelector(".container");t.classList.remove("visible"),setTimeout(()=>{t.classList.add("hidden"),o.classList.remove("slide-up")},500)})});window.addEventListener("load",()=>{const e=localStorage.getItem("restaurantHistory");e&&(d=JSON.parse(e))});
